using Numerics;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;

namespace Diffie_Hellman.Tests
{
	class AESProfiler
	{
		public static void Run(BigInteger secretPhrase)
		{
			//Have to use the same IV
			Random r = new Random();
			byte[] iv = new byte[16];
			r.NextBytes(iv);

			byte[] a = SimpleAES.GenerateEncryptionVector();

			SimpleAES aes1 = new SimpleAES(secretPhrase.GetBytes(), iv);
			SimpleAES aes2 = new SimpleAES(secretPhrase.GetBytes(), iv);

			int numberOfRuns = 10000;

			Stopwatch timer = new Stopwatch();
			timer.Start();

			for (int i = 0; i < numberOfRuns; i++)
			{
				r.NextBytes(iv);
				aes1.SetIV(iv);
				//aes2.SetIV(iv);
				byte[] encrypted = aes1.Encrypt(randomPacket, randomPacket.Length);
				byte[] decrypted = aes2.Decrypt(encrypted, encrypted.Length);
#if DEBUG

				for (int j = 0; j < randomPacket.Length; j++)
				{
					Debug.Assert(decrypted[j] == randomPacket[j]);
				}

#endif
			}

			for (int i = 0; i < numberOfRuns; i++)
			{
				r.NextBytes(iv);
				aes1.SetIV(iv);
				//aes2.SetIV(iv);
				byte[] encrypted = aes2.Encrypt(randomPacket, randomPacket.Length);
				byte[] decrypted = aes1.Decrypt(encrypted, encrypted.Length);

#if DEBUG

				for (int j = 0; j < randomPacket.Length; j++)
				{
					Debug.Assert(decrypted[j] == randomPacket[j]);
				}

#endif
			}


			timer.Stop();
			Console.WriteLine("AESProfiler took " + timer.ElapsedMilliseconds + " millseconds.");
			Console.WriteLine("or " + (double)timer.ElapsedMilliseconds / (double)(numberOfRuns + numberOfRuns) + " millseconds per encrypt + decrypt");
		}


		private static byte[] randomPacket = new byte[] {  114,  81, 140, 206, 237,  63, 177,  86, 122, 250,  42, 194, 244,  91, 217, 158,
				211,  34, 139,  77, 160, 188,  70,  42, 170,  63, 112, 205, 184,  96, 255, 116,
				147, 179, 209, 214,  52, 208, 145, 127, 164, 175, 150, 217, 165, 197,  58, 156,
				159, 255,  87, 138,  55, 206, 191, 244,  17,  19, 122, 237,   7,  61,  92,  66,
				5, 245,  33, 192,  81, 133, 114, 146, 120,  66,   1,  38, 228, 153, 184, 157,
				246, 243, 255, 164, 230,  83, 185,  53,  24, 130, 170,   0,   9, 201, 207,  88,
				182,   2, 101, 194, 185,  56, 188,  21, 139, 241, 127,  13, 177, 249,  48,  56,
				244, 141, 119, 146, 179, 154, 233,  19, 136, 127, 172,  30, 246, 178,  87, 156,
				40,   5, 183, 209, 110, 171,  60, 152,   9,  85, 229, 118, 211,  75, 198,  72,
				252, 115, 175, 148,  33, 224,  40, 105,  76,  85, 227, 176, 227,  91, 216, 175,
				36,  13, 243,  96, 174,  40, 211,  19, 233, 160, 145,  57,  74,  20, 255,  74,
				93,  21, 128, 164, 120, 146, 117, 143,  89,  57, 212,  45,  94, 102,  36, 182,
				180,  46,  91, 215, 205, 118, 155, 188,  26, 132, 248, 242,  55,  61,  89,  69,
				143, 229,   2, 250,  69,  89, 110,  90, 180, 177,  65,  77, 135, 222, 170, 188,
				154, 112,  90, 214, 150,  24, 108, 109, 119,  64, 200,  76, 104,  35, 128,  12,
				117,  90,  54,  58,  22,  51,  38,  94,   5, 218, 120,   5, 130, 107,  14, 206,
				170,   8, 172,  14, 126, 145, 188,  63, 209, 143, 137,  60, 239,  76, 201,  61,
				187, 255,  66,  98,  37,  77, 120, 182,  42, 252, 192, 239, 193,  12, 221, 123,
				146, 123, 130,  80,  52,  71,  10, 235, 191, 238, 152,  71,  25, 196, 189, 231,
				254, 190, 231, 145, 196, 138,  96,  95,  60,  41,  68,   4,  68,  56, 203, 106,
				226,  40, 140, 220, 156, 237,  12, 127, 167, 164, 161, 139,  92, 239,  59,  95,
				89,  47, 150, 188,  84, 175, 244,   0,  98,  18,  32, 118,  39,   9, 249, 186,
				199, 176, 236, 101, 117, 152, 236, 249,  13, 160, 155,  83, 164,  45, 247,  55,
				185,  91, 210, 170, 157, 149, 157, 191, 119, 204, 104, 218, 119,  43,  56,   0,
				23, 188,  39, 164, 162, 195,  33,  75, 129,  67,  45, 186, 108, 210, 159,  72,
				210,  62,  30,  43, 156,  59, 129, 251, 200,  46,  44, 249, 207, 137,  14, 236,
				215, 167, 115,  32, 174, 152, 219,  81, 125, 171, 212,  82, 123, 192, 219,  45,
				97,  71, 255, 198,  99, 189,  96, 209,  94, 147, 208,  89, 185, 248, 187, 103,
				25, 179, 130, 141,  50, 142,  48, 164, 197,  56, 127,  43, 129,  29,  34,  81,
				126,  81, 102,  94, 154, 242, 215,  12, 212, 213, 229, 104, 173,  74, 182, 222,
				109,  22,  54, 179, 250, 162, 253, 241,  75, 227, 155, 130, 197, 222, 191,  78,
				250, 227,  32, 136,  88, 119, 155,  65, 207, 223,  31,  35, 145, 110,  86,   2,
				136,  72,  92, 164, 103,  89, 113,  55, 116,  70, 235, 157,  58, 234,  40, 104,
				61,  14,  53,  30,  66,  52,  66,  92, 108,  92, 205, 127,   3,  92, 254,  88,
				186, 229, 114,  28, 238,  91,  90,  99, 197,  41,   4,  49, 228, 229,   9, 176,
				240, 171,   1, 224,  10, 218,  22, 131, 128, 177, 151, 176,  15,  60,  86, 112,
				226,  65,  81,  10,  13,  59, 114, 203, 182,  60, 254,  64, 250, 158,  82, 138,
				34,   1, 102,  45,  11, 232,  72, 140, 211, 230, 149,  68,  58,   7,  21,  37,
				169,  98,   4, 192, 177, 100, 110,  75,  56, 246,  45,  89, 210,  68, 131,  61,
				194, 143, 108, 201, 209,  92, 187,   6, 174,  23, 200,  94,  57, 179,  68, 242,
				185,  71, 110, 236,  30, 125, 145, 172,  37, 249, 127, 220, 231,  49, 210,  85,
				152,  86, 213,  30,  49, 226, 232, 123, 125,  45,  87, 157, 224,  92, 215, 245,
				23, 239,   3,  17, 141, 132,  22, 112,   1,  40,  37, 117, 212,  43,  91, 105,
				92,  98, 113, 252, 139, 239, 207, 246, 112, 225, 170,  44,  50, 149, 254,  22,
				77,  71, 195, 202,   5,   3, 104, 232,  52, 111, 130,  90, 142,  21, 120, 243,
				23,  54, 106, 179,  77, 117,  24, 153,  81,  40,  36,  62, 151, 100,  65, 182,
				188, 124,  51,  25, 248, 148, 201, 206, 118,  38, 221,  62,  59, 201,  60, 133,
				200,  99, 145, 126,  30, 207, 191,   0,  55, 161,   5, 223,  87,  19, 188,  47,
				121,  46, 231,  25,  58,  63, 121, 156,  35, 163, 169, 104, 113, 224, 252, 130,
				175,  66, 155, 213, 113,  52, 112,  69, 223,  33,  65,  79, 226, 177, 186, 144,
				18,  69, 217,  98,  78, 130,  49,  95, 247,  71,   5,  62,  65,  21, 150, 146,
				5, 127,  66, 248,  40, 117,  92,  96, 102,  34, 221,  64, 105, 158,  19, 109,
				51, 169, 130, 161, 124, 137,  78,  85,  75, 181,  96,  16,  81, 164, 174,  19,
				191, 253, 247,  34, 111, 111, 231, 110, 238, 186, 255,  65,   1, 195, 188, 152,
				62, 109, 155,  71, 227, 172, 133, 251,  77, 228,  63, 169, 167,  28, 208, 174,
				201, 182,  29,  93,  13,  20, 182, 118, 193, 147, 174, 126, 238,  30, 168, 255,
				130, 136,  75, 190, 244, 185,  69, 250, 238, 254,  87,  61, 139, 176, 155, 217,
				5, 186,  14,  71,  37,  97, 146,   6,  90,   9, 165, 248,  49, 235,  41, 233,
				211, 179, 125,  42, 139, 107,  30, 158, 182,  52,  67,  96,  97, 135, 215, 100,
				26, 136, 177, 123, 208, 184, 251, 154,  80,  51,  74,  61, 130, 204,  20, 106,
				108, 222, 212,  65, 239,  73, 216, 140, 155, 226, 163, 121,  71,  79,   9, 119,
				118,  43,  41, 127,   5,   5, 137,  88,  30, 202, 154,  44,  33, 240,  96,  77,
				87,  63,  79, 212, 202,  23, 143, 157, 106, 196, 220, 155, 107,  20,  88, 229,
				47, 221, 120, 137, 244, 180,   4, 148,  37, 183,  48, 226, 167, 229,  95,  48,
				61,  24,  44,  31,  65, 162, 149, 102, 204, 120, 152, 184, 199,  54,   4, 183,
				109,  63,  72,  46, 201,  46, 131, 155,  87, 215, 156,  87, 186, 205, 198, 249,
				118, 249, 229,  42, 131, 145, 238, 242,  81, 129, 175, 101, 227,  96, 159,  23,
				36,  52, 117,  89, 102,  17,  16, 103,  97, 143, 149, 108,  39, 163,   9,  33,
				207, 222, 109, 217, 126, 152, 228, 124,  70,   3,  86, 220
														};


	}
}
